---
title: "자바 NIO와 Netty"
date: 2021-09-27T11:50:00+09:00
categories:
  - 메모
tag:
  - 자바
  - NIO
  - IO
header:
  teaser: /assets/images/slipBox.jpg
toc: true
toc_sticky: true
---
## IO란
IO는 입력과 출력의 약자로 컴퓨터 및 주변 장치에 대해서 데이터를 전송하는 프로그램 운영 혹은 장치를 말한다. IO는 다른 프로그램에 비하여 상대적으로 느리다. 

자바의 NIO(Non-Blocking Input Ouput) 방식 이전의 소켓 프로그래밍의 대표적인 문제점은 클라이언트가 접속하게 되면 스레드를 1대1로 할당해야한다는 점이었다. 이 경우 정말 많은 클라이언트가 접속을 하게 되면 그 숫자만큼 스레드를 생성해야 해서 리소스의 낭비가 벌어지거나, 문맥 교환시나 입출력 시에 무한 대기 현상이 발생한다. 

자바의 NIO에서는 이러한 동기 방식의 문제점을 해결하기 위해 IO와는, 입출력 방식, 버퍼 방식, 비동기 방식, 블로킹 방식에서 차이를 보인다.

## 입출력 방식
IO의 입출력 방식은 스트림 기반이다. 데이터를 읽기 위해서 입력 스트림을 생성하고, 데이터를 출력하기 위해서 출력 스트림을 생성한다. 

NIO의 입출력 방식은 채널 기반이다. 스트림과 달리 양방향으로 입력과 출력이 가능하며 별도의 채널을 만들 필요가 없다. 

## 버퍼 방식
IO는 기본적으로는 버퍼를 사용하지 않고 출력 스트림이 1바이트를 쓰면 입력 스트림이 1바이트를 읽는다. IO는 스트림에서 읽은 데이터를 즉시 처리하기 때문에 입력된 전체 데이터를 별도로 저장하는 과정이 필요하다. 버퍼를 사용하면 복수의 바이트를 한꺼번에 입력받고 출력할 수 있다. 

NIO에서는 기본적으로 버퍼를 사용해서 출력한다. 채널은 버퍼에 저장된 데이터를 출력하고 입력된 데이터를 버퍼에 저장한다. 버퍼 내에서 데이터의 위치를 이동해가면서 필요한 부분만 읽고 쓸수 있다. 

## 넌블로킹 방식 지원 여부
IO는 입력 스트림의 read() 출력 스트림의 write() 메소드를 호출하면 블로킹이 된다. 블로킹이 되면 다른 일을 할 수 없고 블로킹을 빠져나오기 위해 인터럽트도 할 수 없다. 블로킹을 빠져나오는 방법은 스트림을 받는 것이다. 

NIO의 블로킹은 스레드를 인터럽트함으로써 빠져나올 수가 있다. NIO의 넌블로킹은 입출력 작업 준비가 완료된 채널만 선택해서 작업 스레드가 처리하기 때문에 작업 스레드가 블로킹되지 않는다. NIO 넌블로킹의 핵심 객체는 멀티플렉서의 Selector이다. 클라이언트 하나당 쓰레드 하나를 생성해서 처리한다. 셀렉터는 복수의 채널 중에서 이벤트가 준비 완료된 채널을 선택하는 방법을 제공해준다. 

## Netty
네티는 NIO 클라이언트 서버 프레임워크이다.비동기 이면서 이벤트 기반으로 동작한다.
